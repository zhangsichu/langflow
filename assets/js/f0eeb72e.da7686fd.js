"use strict";(self.webpackChunklangflow_docs=self.webpackChunklangflow_docs||[]).push([[9897],{11470:(e,o,n)=>{n.d(o,{A:()=>w});var t=n(96540),s=n(18215),r=n(23104),l=n(56347),a=n(205),i=n(57485),c=n(31682),d=n(70679);function p(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:o}=e;return!!o&&"object"==typeof o&&"value"in o}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:o,children:n}=e;return(0,t.useMemo)(()=>{const e=o??function(e){return p(e).map(({props:{value:e,label:o,attributes:n,default:t}})=>({value:e,label:o,attributes:n,default:t}))}(n);return function(e){const o=(0,c.XI)(e,(e,o)=>e.value===o.value);if(o.length>0)throw new Error(`Docusaurus error: Duplicate values "${o.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[o,n])}function h({value:e,tabValues:o}){return o.some(o=>o.value===e)}function g({queryString:e=!1,groupId:o}){const n=(0,l.W6)(),s=function({queryString:e=!1,groupId:o}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!o)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return o??null}({queryString:e,groupId:o});return[(0,i.aZ)(s),(0,t.useCallback)(e=>{if(!s)return;const o=new URLSearchParams(n.location.search);o.set(s,e),n.replace({...n.location,search:o.toString()})},[s,n])]}function f(e){const{defaultValue:o,queryString:n=!1,groupId:s}=e,r=u(e),[l,i]=(0,t.useState)(()=>function({defaultValue:e,tabValues:o}){if(0===o.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:o}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${o.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=o.find(e=>e.default)??o[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:o,tabValues:r})),[c,p]=g({queryString:n,groupId:s}),[f,m]=function({groupId:e}){const o=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,s]=(0,d.Dv)(o);return[n,(0,t.useCallback)(e=>{o&&s.set(e)},[o,s])]}({groupId:s}),y=(()=>{const e=c??f;return h({value:e,tabValues:r})?e:null})();(0,a.A)(()=>{y&&i(y)},[y]);return{selectedValue:l,selectValue:(0,t.useCallback)(e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),p(e),m(e)},[p,m,r]),tabValues:r}}var m=n(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(74848);function b({className:e,block:o,selectedValue:n,selectValue:t,tabValues:l}){const a=[],{blockElementScrollPositionUntilNextRender:i}=(0,r.a_)(),c=e=>{const o=e.currentTarget,s=a.indexOf(o),r=l[s].value;r!==n&&(i(o),t(r))},d=e=>{let o=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;o=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;o=a[n]??a[a.length-1];break}}o?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":o},e),children:l.map(({value:e,label:o,attributes:t})=>(0,x.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:c,...t,className:(0,s.A)("tabs__item",y.tabItem,t?.className,{"tabs__item--active":n===e}),children:o??e},e))})}function j({lazy:e,children:o,selectedValue:n}){const r=(Array.isArray(o)?o:[o]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===n);return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map((e,o)=>(0,t.cloneElement)(e,{key:o,hidden:e.props.value!==n}))})}function v(e){const o=f(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",y.tabList),children:[(0,x.jsx)(b,{...o,...e}),(0,x.jsx)(j,{...o,...e})]})}function w(e){const o=(0,m.A)();return(0,x.jsx)(v,{...e,children:p(e.children)},String(o))}},19365:(e,o,n)=>{n.d(o,{A:()=>l});n(96540);var t=n(18215);const s={tabItem:"tabItem_Ymn6"};var r=n(74848);function l({children:e,hidden:o,className:n}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,n),hidden:o,children:e})}},28453:(e,o,n)=>{n.d(o,{R:()=>l,x:()=>a});var t=n(96540);const s={},r=t.createContext(s);function l(e){const o=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:o},e.children)}},61227:(e,o,n)=>{n.r(o),n.d(o,{CH:()=>u,assets:()=>p,chCodeConfig:()=>h,contentTitle:()=>d,default:()=>m,frontMatter:()=>c,metadata:()=>t,toc:()=>g});const t=JSON.parse('{"id":"Develop/enterprise-database-guide","title":"Langflow database guide for enterprise DBAs","description":"The Langflow database stores data that is essential for more Langflow operations, including startup, flow execution, user interactions, and administrative tasks.","source":"@site/docs/Develop/enterprise-database-guide.mdx","sourceDirName":"Develop","slug":"/enterprise-database-guide","permalink":"/enterprise-database-guide","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Langflow database guide for enterprise DBAs","slug":"/enterprise-database-guide"},"sidebar":"docs","previous":{"title":"Configure an external PostgreSQL database","permalink":"/configuration-custom-database"},"next":{"title":"Logs","permalink":"/logging"}}');var s=n(74848),r=n(28453),l=n(24754),a=n(11470),i=n(19365);const c={title:"Langflow database guide for enterprise DBAs",slug:"/enterprise-database-guide"},d=void 0,p={},u={annotations:l.hk,Code:l.Cy},h={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:!0,showCopyButton:!0,themeName:"github-dark"},g=[{value:"Configure Langflow with PostgreSQL",id:"configure-langflow-with-postgresql",level:2},{value:"High Availability for PostgreSQL",id:"high-availability-for-postgresql",level:3},{value:"Impact of database failure",id:"impact-of-database-failure",level:2},{value:"Database monitoring",id:"database-monitoring",level:2},{value:"See also",id:"see-also",level:2}];function f(e){const o={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return u||y("CH",!1),u.Code||y("CH.Code",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="github-dark"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #c9d1d9;--ch-t-background: #0d1117;--ch-t-lighter-inlineBackground: #0d1117e6;--ch-t-editor-background: #0d1117;--ch-t-editor-foreground: #c9d1d9;--ch-t-editor-lineHighlightBackground: #6e76811a;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #1f6feb;--ch-t-tab-activeBackground: #0d1117;--ch-t-tab-activeForeground: #c9d1d9;--ch-t-tab-inactiveBackground: #010409;--ch-t-tab-inactiveForeground: #8b949e;--ch-t-tab-border: #30363d;--ch-t-tab-activeBorder: #0d1117;--ch-t-editorGroup-border: #30363d;--ch-t-editorGroupHeader-tabsBackground: #010409;--ch-t-editorLineNumber-foreground: #6e7681;--ch-t-input-background: #0d1117;--ch-t-input-foreground: #c9d1d9;--ch-t-input-border: #30363d;--ch-t-icon-foreground: #8b949e;--ch-t-sideBar-background: #010409;--ch-t-sideBar-foreground: #c9d1d9;--ch-t-sideBar-border: #30363d;--ch-t-list-activeSelectionBackground: #6e768166;--ch-t-list-activeSelectionForeground: #c9d1d9;--ch-t-list-hoverBackground: #6e76811a;--ch-t-list-hoverForeground: #c9d1d9; }'}}),"\n","\n",(0,s.jsxs)(o.p,{children:["The Langflow database stores data that is essential for more Langflow operations, including startup, flow execution, user interactions, and administrative tasks.\nThe database supports both frontend (visual editor) and backend (API) operations, making its availability critical to Langflow's stability and functionality.\nFor details about the database schema, see ",(0,s.jsx)(o.a,{href:"/memory",children:"Memory management options"}),"."]}),"\n",(0,s.jsx)(o.p,{children:"This guide is designed for enterprise database administrators (DBAs) and operators responsible for deploying and managing Langflow in production environments.\nIt explains how to configure Langflow to use PostgreSQL, including high availability (HA) and active-active configurations, as well as best practices for monitoring, maintenance, and security."}),"\n",(0,s.jsx)(o.h2,{id:"configure-langflow-with-postgresql",children:"Configure Langflow with PostgreSQL"}),"\n",(0,s.jsx)(o.p,{children:"Langflow's default database is SQLite.\nHowever, PostgreSQL is recommended for production deployments due to its scalability, performance, and robustness."}),"\n",(0,s.jsxs)(o.p,{children:["The following steps explain how to configure Langflow to use PostgreSQL for a standalone or containerized deployment.\nFor more information, see ",(0,s.jsx)(o.a,{href:"/configuration-custom-database",children:"Configure an external PostgreSQL database"}),"."]}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Set up PostgreSQL:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsx)(o.li,{children:"Deploy a PostgreSQL instance (version 12 or higher recommended) using a local server, Docker, or a managed cloud service."}),"\n",(0,s.jsx)(o.li,{children:"Create a database for Langflow."}),"\n",(0,s.jsx)(o.li,{children:"Create a PostgreSQL user with appropriate, minimal permissions to manage and write to the database, such as CREATE, SELECT, INSERT, UPDATE, DELETE on your Langflow tables."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Obtain the connection string in the format ",(0,s.jsx)(o.code,{children:"postgresql://user:password@host:port/dbname"}),", such as",(0,s.jsx)(o.code,{children:"postgresql://langflow:securepassword@postgres:5432/langflow"}),"."]}),"\n",(0,s.jsxs)(o.p,{children:["For High Availability, use the virtual IP or proxy hostname instead of the direct database host.\nFor more information, see ",(0,s.jsx)(o.a,{href:"#high-availability-for-postgresql",children:"High Availability for PostgreSQL"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Configure Langflow with the ",(0,s.jsx)(o.code,{children:".env"})," or ",(0,s.jsx)(o.code,{children:"docker-compose.yml"})," files."]}),"\n",(0,s.jsxs)(a.A,{groupId:"environment",children:[(0,s.jsxs)(i.A,{value:".env",label:".env",default:!0,children:[(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Create a ",(0,s.jsx)(o.code,{children:".env"})," file in the ",(0,s.jsx)(o.code,{children:"langflow"})," directory:"]}),"\n",(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"touch ",props:{style:{color:"#FFA657"}}},{content:".env",props:{style:{color:"#A5D6FF"}}}]}],lang:"shell"},annotations:[]}]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Add the connection string to the ",(0,s.jsx)(o.code,{children:".env"})," file:"]}),"\n",(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:'LANGFLOW_DATABASE_URL="postgresql://langflow:securepassword@postgres:5432/langflow"',props:{}}]}],lang:"text"},annotations:[]}]}),"\n"]}),"\n"]}),(0,s.jsxs)(o.p,{children:["For more environment variables, see the ",(0,s.jsx)(o.code,{children:".env.example"})," file in the Langflow repository."]})]}),(0,s.jsxs)(i.A,{value:"docker-compose.yml",label:"docker-compose.yml",children:[(0,s.jsxs)(o.p,{children:["Use the sample ",(0,s.jsx)(o.code,{children:"docker-compose.yml"})," from the Langflow Repository.\nYou can use the default values or customize them as needed."]}),(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"version",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"'3'",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"services",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  langflow",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"    image",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflowai/langflow:latest",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    ports",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:'"7860:7860"',props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    environment",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"LANGFLOW_DATABASE_URL=postgresql://langflow:langflow@postgres:5432/langflow",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"  postgres",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"    image",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"postgres:16",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    ports",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:'"5432:5432"',props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    environment",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"POSTGRES_USER=langflow",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"POSTGRES_PASSWORD=langflow",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"POSTGRES_DB=langflow",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    volumes",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-postgres:/var/lib/postgresql/data",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"volumes",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  - ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-postgres",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]}],lang:"yaml"},annotations:[]}]})]})]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Start Langflow with your PostgreSQL connection:"}),"\n",(0,s.jsxs)(a.A,{groupId:"environment",children:[(0,s.jsx)(i.A,{value:".env",label:".env",default:!0,children:(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"uv ",props:{style:{color:"#FFA657"}}},{content:"run langflow run ",props:{style:{color:"#A5D6FF"}}},{content:"--env-file ",props:{style:{color:"#79C0FF"}}},{content:".env",props:{style:{color:"#A5D6FF"}}}]}],lang:"shell"},annotations:[]}]})}),(0,s.jsx)(i.A,{value:"docker-compose.yml",label:"docker-compose.yml",children:(0,s.jsxs)(o.p,{children:["Navigate to the directory containing ",(0,s.jsx)(o.code,{children:"docker-compose.yml"}),", and then run ",(0,s.jsx)(o.code,{children:"docker-compose up"}),"."]})})]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Optional: Run migrations."}),"\n",(0,s.jsx)(o.p,{children:"Langflow uses migrations to manage its database schema.\nWhen you first connect to PostgreSQL, Langflow automatically runs migrations to create the necessary tables."}),"\n",(0,s.jsx)(o.p,{children:"Direct schema modification can cause conflicts with Langflow's built-in schema management.\nIf you need to update the schema, you can manually run migrations with the Langflow CLI:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Run ",(0,s.jsx)(o.code,{children:"langflow migration"})," to preview the changes."]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Review the changes to ensure that it's safe to proceed with the migration."}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Run ",(0,s.jsx)(o.code,{children:"langflow migration --fix"})," to run the migration and permanently apply the changes."]}),"\n",(0,s.jsxs)(o.p,{children:["This is a destructive operation that can delete data.\nFor more information, see ",(0,s.jsx)(o.a,{href:"/configuration-cli#langflow-migration",children:(0,s.jsx)(o.code,{children:"langflow migration"})}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"To verify the configuration, create any flow using the Langflow visual editor or API, and then query your database to confirm the tables and activity are recorded there. The content of the flow doesn't matter; you only need to confirm that the flow is stored in your PostgreSQL database.\nYou can query the database in two ways:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Query the database container:"}),"\n",(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"docker exec -it <postgres-container> psql -U langflow -d langflow",props:{}}]}],lang:"text"},annotations:[]}]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Use SQL:"}),"\n",(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"SELECT * FROM pg_stat_activity WHERE datname = 'langflow';",props:{}}]}],lang:"text"},annotations:[]}]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(o.h3,{id:"high-availability-for-postgresql",children:"High Availability for PostgreSQL"}),"\n",(0,s.jsx)(o.p,{children:"To further improve performance, reliability, and scalability, use a High Availability (HA) or Active-Active HA PostgreSQL configuration.\nThis is recommended for production deployments to minimize downtime and ensure continuous operations if your database server fails, especially when multiple Langflow instances rely on the same database."}),"\n",(0,s.jsxs)(a.A,{children:[(0,s.jsx)(i.A,{value:"HA",label:"High Availability (HA)",default:!0,children:(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Set up streaming replication:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Configure one primary database for writes."}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Configure one or more replicas for reads and failover."}),"\n",(0,s.jsx)(o.p,{children:"Select either synchronous or asynchronous replication based on your latency and consistency requirements."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Implement automatic failover using one of the following options:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Use an HA orchestrator, distributed configuration store, and traffic router, such as ",(0,s.jsx)(o.a,{href:"https://patroni.readthedocs.io/en/latest/",children:"Patroni"}),", etcd or ",(0,s.jsx)(o.a,{href:"https://developer.hashicorp.com/consul",children:"Consul"}),", and ",(0,s.jsx)(o.a,{href:"https://www.haproxy.org/",children:"HAProxy"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Use ",(0,s.jsx)(o.a,{href:"https://www.pgpool.net/docs/46/en/html/index.html",children:"Pgpool-II"})," alone or add supporting services for more robust HA support."]}),"\n",(0,s.jsx)(o.li,{children:"Use managed services that provide built-in HA with automatic failover, such as AWS RDS or Google Cloud SQL."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Update your PostgreSQL connection string to point to the HA setup.\nIf you have a multi-instance deployment, make sure all of your Langflow instances connect to the same HA PostgreSQL database."}),"\n",(0,s.jsx)(o.p,{children:"The connection string you use depends on your HA configuration and services."}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Use a virtual IP or DNS name that resolves to the current primary database, such as ",(0,s.jsx)(o.code,{children:"postgresql://langflow:securepassword@db-proxy:5432/langflow?sslmode=require"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Use the provided endpoint for a managed service, such as ",(0,s.jsx)(o.code,{children:"langflow.cluster-xyz.us-east-1.rds.amazonaws.com"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Optional: Implement load balancing for read-heavy workloads:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["Use a connection pooler like ",(0,s.jsx)(o.a,{href:"https://www.pgbouncer.org/",children:"PgBouncer"})," to distribute read queries across replicas."]}),"\n",(0,s.jsx)(o.li,{children:"Configure Langflow to use a single connection string pointing to the primary PostgreSQL database or proxy."}),"\n"]}),"\n"]}),"\n"]})}),(0,s.jsxs)(i.A,{value:"AA",label:"Active-Active HA",children:[(0,s.jsx)(o.p,{children:"To implement Active-Active HA, you must deploy multiple Langflow instances, use load balancing to distribute traffic across the instances, and ensure all instances connect to the same HA PostgreSQL database:"}),(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Deploy multiple Langflow instances using Kubernetes or Docker Swarm."}),"\n",(0,s.jsxs)(o.p,{children:["You must configure your instances to use a shared PostgreSQL database.\nFor more information, see ",(0,s.jsx)(o.a,{href:"/deployment-prod-best-practices",children:"Best practices for Langflow on Kubernetes"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Set up streaming replication:"}),"\n",(0,s.jsxs)(o.ol,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Configure one primary database for writes."}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Configure one or more replicas for reads and failover."}),"\n",(0,s.jsx)(o.p,{children:"Select either synchronous or asynchronous replication based on your latency and consistency requirements."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Implement automatic failover using one of the following options:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Use an HA orchestrator, distributed configuration store, and traffic router, such as ",(0,s.jsx)(o.a,{href:"https://patroni.readthedocs.io/en/latest/",children:"Patroni"}),", etcd or ",(0,s.jsx)(o.a,{href:"https://developer.hashicorp.com/consul",children:"Consul"}),", and ",(0,s.jsx)(o.a,{href:"https://www.haproxy.org/",children:"HAProxy"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Use ",(0,s.jsx)(o.a,{href:"https://www.pgpool.net/docs/46/en/html/index.html",children:"Pgpool-II"})," alone or add supporting services for more robust HA support."]}),"\n",(0,s.jsx)(o.li,{children:"Use managed services that provide built-in HA with automatic failover, such as AWS RDS or Google Cloud SQL."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Update your PostgreSQL connection string to point to the HA setup.\nMake sure all of your Langflow instances connect to the same HA PostgreSQL database."}),"\n",(0,s.jsx)(o.p,{children:"The connection string you use depends on your HA configuration and services:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["Use a virtual IP or DNS name that resolves to the current primary database, such as ",(0,s.jsx)(o.code,{children:"postgresql://langflow:securepassword@db-proxy:5432/langflow?sslmode=require"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Use the provided endpoint for a managed service, such as ",(0,s.jsx)(o.code,{children:"langflow.cluster-xyz.us-east-1.rds.amazonaws.com"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Use a load balancer to distribute requests across your instances."}),"\n"]}),"\n"]}),(0,s.jsxs)(o.p,{children:["The following example configuration is for a production deployment that has three ",(0,s.jsx)(o.code,{children:"langflow-runtime"})," replicas, uses the Kubernetes load balancer service to distribute traffic to healthy pods, and uses the HA PostgreSQL database connection string."]}),(0,s.jsx)(u.Code,{codeConfig:h,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"apiVersion",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"apps/v1",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"kind",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"Deployment",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"metadata",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  name",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-runtime",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"spec",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  replicas",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"3",props:{style:{color:"#79C0FF"}}}]},{tokens:[{content:"  selector",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"    matchLabels",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      app",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-runtime",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"  template",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"    metadata",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      labels",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"        app",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-runtime",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"    spec",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      containers",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"      - ",props:{style:{color:"#C9D1D9"}}},{content:"name",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"        image",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflowai/langflow:latest",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"        ports",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"        - ",props:{style:{color:"#C9D1D9"}}},{content:"containerPort",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"7860",props:{style:{color:"#79C0FF"}}}]},{tokens:[{content:"        env",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"        - ",props:{style:{color:"#C9D1D9"}}},{content:"name",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"LANGFLOW_DATABASE_URL",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"          value",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:'"postgresql://langflow:securepassword@db-proxy:5432/langflow?sslmode=require"',props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"---",props:{style:{color:"#79C0FF"}}}]},{tokens:[{content:"apiVersion",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"v1",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"kind",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"Service",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"metadata",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  name",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-runtime",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"spec",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  selector",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"    app",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"langflow-runtime",props:{style:{color:"#A5D6FF"}}}]},{tokens:[{content:"  ports",props:{style:{color:"#7EE787"}}},{content:":",props:{style:{color:"#C9D1D9"}}}]},{tokens:[{content:"  - ",props:{style:{color:"#C9D1D9"}}},{content:"port",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"80",props:{style:{color:"#79C0FF"}}}]},{tokens:[{content:"    targetPort",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"7860",props:{style:{color:"#79C0FF"}}}]},{tokens:[{content:"  type",props:{style:{color:"#7EE787"}}},{content:": ",props:{style:{color:"#C9D1D9"}}},{content:"LoadBalancer",props:{style:{color:"#A5D6FF"}}}]}],lang:"yaml"},annotations:[]}]})]})]}),"\n",(0,s.jsxs)(o.p,{children:["After implementing HA or Active-Active HA, monitor failover events and ensure replicas are in sync.\nLangflow, through ",(0,s.jsx)(o.a,{href:"https://docs.sqlalchemy.org/en/20/",children:"SQLAlchemy"}),", supports reconnection attempts if ",(0,s.jsx)(o.code,{children:"LANGFLOW_DATABASE_CONNECTION_RETRY=True"}),", ensures recovery after failover, and reduces disruption once the database is back online."]}),"\n",(0,s.jsx)(o.p,{children:"Although PostgreSQL handles concurrent connections well, you must still monitor for contention, deadlocks, or other performance degradation during high load."}),"\n",(0,s.jsx)(o.h2,{id:"impact-of-database-failure",children:"Impact of database failure"}),"\n",(0,s.jsx)(o.p,{children:"If the PostgreSQL database becomes unavailable, the following Langflow functions will fail:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Flow Retrieval"}),": Cannot load new or existing flows from the database."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Flow Saving"}),": Unable to save new flows or updates to existing flows."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"User Authentication"}),": Login and user management functions fail."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Project Collection Access"}),": Cannot access or share community/custom project collections."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Configuration Retrieval"}),": Unable to load application settings."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Configuration Updates"}),": Changes to settings cannot be saved."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Execution Log Access"}),": Cannot retrieve historical flow execution logs."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Log Writing"}),": New execution or system activity logs cannot be recorded."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"Multi-User Collaboration"}),": Sharing flows or projects across users fails."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.strong,{children:"API Flow Loading"}),": API requests to load new flows (non-cached) fail."]}),"\n"]}),"\n",(0,s.jsx)(o.p,{children:"Flows already loaded in memory may continue to function with cached configurations.\nHowever, any operation requiring database access fails until the database is restored.\nFor example, a cached flow might run, but it won't record logs or message history to the database."}),"\n",(0,s.jsxs)(o.p,{children:["To minimize the possibility and impact of database failure, use ",(0,s.jsx)(o.a,{href:"#high-availability-for-postgresql",children:"HA configurations"})," and record backups regularly.\nFor example, you can use ",(0,s.jsx)(o.code,{children:"pg_dump"})," to create logical backups or set up continuous archiving with write-ahead logs (WAL) for point-in-time recovery.\nTest restoration procedures regularly to ensure your team understands how to execute them in a disaster recovery scenario."]}),"\n",(0,s.jsx)(o.h2,{id:"database-monitoring",children:"Database monitoring"}),"\n",(0,s.jsx)(o.p,{children:"Monitor your PostgreSQL database to ensure optimal performance and reliability:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:"Use tools like pgAdmin, Prometheus with PostgreSQL exporter, or cloud-based monitoring for PostgreSQL."}),"\n",(0,s.jsx)(o.li,{children:"Track performance metrics such as CPU, memory, and disk I/O usage."}),"\n",(0,s.jsxs)(o.li,{children:["Monitor replica health, availability, lag, and synchronization.\nFor example, use ",(0,s.jsx)(o.code,{children:"pg_stat_activity"})," to monitor connection counts and contention."]}),"\n",(0,s.jsx)(o.li,{children:"Set up alerts and notifications for high latency, failover events, or replication issues."}),"\n",(0,s.jsxs)(o.li,{children:["Enable PostgreSQL logging, such as ",(0,s.jsx)(o.code,{children:"log_connections"})," and ",(0,s.jsx)(o.code,{children:"log_statements"}),", to track access and changes."]}),"\n"]}),"\n",(0,s.jsx)(o.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.a,{href:"/configuration-custom-database",children:"Configure an external PostgreSQL database"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.a,{href:"/deployment-architecture",children:"Langflow architecture on Kubernetes"})}),"\n",(0,s.jsx)(o.li,{children:(0,s.jsx)(o.a,{href:"/deployment-kubernetes-prod",children:"Deploy the Langflow production environment on Kubernetes"})}),"\n"]})]})}function m(e={}){const{wrapper:o}={...(0,r.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(f,{...e})}):f(e)}function y(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);